<%# The page for showing the user account details %>
<%# Polar Survey %>
<%# @author Aun Raza (301074590) %>
<%# @author Jamee Kim (301058465) %>
<%# @author Jerome Ching (300817930) %>
<%# @author Sophie Xu (301098127) %>
<%# @author Tien Sang Nguyen (301028223) %>
<%# @author Eunju Jo (301170731) %>

<!-- User Account Information Section -->
<div class="row justify-content-center mb-5">

  <h1 class="text-center polarText display-1">Account</h1>
  <div class="my-4 border border-dark col-5 logoGray border-3">
    <div class="row justify-content-center my-4">
      <p>User Name: <%=user.username %></p>
      <p>E-mail:<%=user.emailAddress %></p>
      <p>Contact Number: <%=user.contactNumber %></p>
    </div>

    <div class="row justify-content-center mb-5">
      <a href="/edituser/<%= user._id %>" class="btn btn-primary col-4">Edit User</a>
    </div>
  </div>

</div>

<!-- The List of the User's Surveys -->
<div class="row justify-content-center mb-5">
  <a href="/makesurvey" class="btn btn-primary col-4">Make A Survey</a>
</div>
<h1 class="text-center polarText">Survey List</h1>
<div class="row mb-5">
  <div class="col">
    <table class="table border border-dark mb-5">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Title</th>
          <th scope="col">Available From</th>
          <th scope="col">Expires At</th>
          <th scope="col">Active Override</th>
          <th scope="col">Updated At</th>


          <th></th>
          <th></th>
          <th></th>


        </tr>
      </thead>
      <tbody>

        <!--Repeatable Row Template-->
        <% for(let count = 0; count < survey.length; count++){ %>
        <tr>
          <th scope="row"><%= count + 1 %></th>
          <td><%= survey[count].title %></td>
          <td><%= displayDate(survey[count].activeFrom) %></td>
          <td><%= displayDate(survey[count].expiresAt) %></td>
          <td>
            <%= typeof survey[count].activeOverride !== "boolean" ? "" :
              survey[count].activeOverride ? "Active" : "Inactive" %>
          </td>
          <td><%= displayDate(survey[count].updatedAt) %></td>
          <td class="text-center">
            <a href="/surveyresponse/<%= survey[count]._id %>" class="btn btn-primary btn edit">
              <i class="fas fa-edit fa-sm"></i> Results
            </a>
          </td>
          <td class="text-center">
            <a href="/editsurvey/<%= survey[count]._id %>" class="btn btn-primary btn edit">
              <i class="fas fa-edit fa-sm"></i> Edit
            </a>
          </td>
          <td class="text-center">
            <a href="/delete/<%= survey[count]._id %>" class="btn btn-danger delete" title="delete"
              onclick="return confirm('Are you sure you want to delete this survey?')">
              <i class="fas fa-trash-alt fa-sm"></i> Delete
            </a>
          </td>
        </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</div>

<!-- All Responses -->
<h1 class="text-center polarText">Survey Results</h1>
<div class="row mb-5">
  <div class="col">
    <table class="table border border-dark">
      <thead>
        <br><br>
        <tr>
          <th scope="col">#</th>
          <th scope="col">DB Serial</th>
          <th scope="col">Title</th>
          <th scope="col">Answer1</th>
          <th scope="col">Answer2</th>
          <th scope="col">Answer3</th>
          <th scope="col">Answer4</th>
          <th scope="col">Answer5</th>
          <th></th>
        </tr>
      </thead>
      <tbody>

        <!--Repeatable Row Template-->

        <% for(let count = 0; count < response.length; count++){ %>
        <tr>
          <th scope="row" class="polarPurpleText"><%= count + 1 %></th>
          <td><%= response[count].question %></td>
          <td><%= response[count].title %></td>
          <td><%= response[count].answers[0] %></td>
          <td><%= response[count].answers[1] %></td>
          <td><%= response[count].answers[2] %></td>
          <td><%= response[count].answers[3] %></td>
          <td><%= response[count].answers[4] %></td>
          <td class="text-center">
            <a href="/deleteres/<%= response[count]._id %>" class="btn btn-danger editBTN" title="delete"
              onclick="return confirm('Are you sure you want to delete this survey?')">
              Delete</a>
          </td>
        </tr>
        <% } %>
      </tbody>
    </table>
  </div>
